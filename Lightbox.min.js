(function(a){'use strict';function b(d){var f=this;if(this.dragdealer=null,this.settings={items:[],itemsKey:0,container:document.querySelector('body'),backgroundHtml:'<div class="lightbox-background lightbox-opacity-animation"></div>',closeHtml:'<div class="lightbox-close lightbox-opacity-animation"></div>',contentContainerHtml:'<div class="lightbox-content-container lightbox-opacity-animation"></div>',multipleItemsClass:'multiple-items',multipleItemsContainerHtml:'<div></div>',multipleItemsContainerClass:'lightbox-multiple-items-container',contentHtml:'<div class="lightbox-content"></div>',contentClassIos:'ios',contentClassIframe:'lightbox-content-iframe',contentClassImage:'lightbox-content-image',contentClassGet:'lightbox-content-ajax lightbox-content-get',contentClassPost:'lightbox-content-ajax lightbox-content-post',iframeClass:'lightbox-iframe',iframeTransparencyMode:!0,htmlActiveClass:'lightbox-active',previousHtml:'<div class="lightbox-previous lightbox-opacity-animation"></div>',nextHtml:'<div class="lightbox-next lightbox-opacity-animation"></div>',infoHtml:'<div class="lightbox-info lightbox-opacity-animation"></div>',loadingHtml:'<div class="lightbox-loading lightbox-opacity-animation"><i class="fa fa-spinner fa-spin fa-fw"></i></div>',closeOnBackgroundClick:!0,imageLoadTimeout:10,pathToRequirejsDragdealer:'dragdealer.min'},'object'==typeof d)for(var g in d)d.hasOwnProperty(g)&&'undefined'!=typeof this.settings[g]&&(this.settings[g]=d[g]);this.backgroundElement=null,this.closeElement=null,this.contentContainerElement=null,this.infoElement=null,this.previousElement=null,this.nextElement=null;var h=function(j){var k=this;return this.isVisible=!0,this.html=j.trim(),this.element=null,this.get=function(){if(null===this.element||'object'!=typeof this.element){let l=document.createElement('template');l.innerHTML=this.html,this.element=l.content.firstChild}return this.element},this.show=function(){!1===this.isVisible&&(this.get().style.opacity=1,this.isVisible=!0)},this.hide=function(){!0===this.isVisible&&(this.get().style.opacity=0,this.isVisible=!1)},this.remove=function(){this.get().parentNode.removeChild(this.get())},this.hideAndRemove=function(l){this.hide(),a.setTimeout(function(){k.remove(),'function'==typeof l&&l()},300)},this.addClass=function(l){if(0<=l.trim().indexOf(' ')){let m=l.split(' ');for(let n=0;n<m.length;n++)m[n].trim()&&this.get().classList.add(m[n].trim())}else this.get().classList.add(l.trim())},this.removeClass=function(l){if(0<=l.trim().indexOf(' ')){let m=l.split(' ');for(let n=0;n<m.length;n++)m[n].trim()&&this.get().classList.remove(m[n])}else this.get().classList.remove(l.trim())},this};this.set=function(j,k){return'undefined'!=typeof this.settings[j]&&(this.settings[j]=k),this},this.addItem=function(j){return'string'==typeof j.target?(this.settings.items.push({target:j.target,mode:j.mode||'iframe',title:j.title||'',data:j.data||null,callback:j.callback||null}),this):null},this.event={addEvent:function(j,k,l){j.addEventListener(k,l,!1)},removeEvent:function(j,k,l){j.removeEventListener(k,l,!1)},preventDefault:function(j){j.preventDefault()},itemCallback:function(j){j.callback&&'function'==typeof j.callback&&j.callback(j,f)}},this.open=function(){if('object'!=typeof this.settings.items[this.settings.itemsKey])return console.log('Error in Lightbox: No items defined!'),null;if(this.backgroundElement=new h(this.settings.backgroundHtml),this.backgroundElement.hide(),this.settings.container.appendChild(this.backgroundElement.get()),this.backgroundElement.show(),!0===this.settings.closeOnBackgroundClick&&this.event.addEvent(this.backgroundElement.get(),'click',function(){f.close()}),this.closeElement=new h(this.settings.closeHtml),this.closeElement.hide(),this.settings.container.appendChild(this.closeElement.get()),this.closeElement.show(),this.event.addEvent(this.closeElement.get(),'click',function(){f.close()}),this.contentContainerElement=new h(this.settings.contentContainerHtml),this.settings.container.appendChild(this.contentContainerElement.get()),this.contentContainerElement.multipleItemsContainer=null,this.contentContainerElement.addContentElement=function(l){1<f.settings.items.length?(null===this.multipleItemsContainer&&(this.multipleItemsContainer=new h(f.settings.multipleItemsContainerHtml),this.multipleItemsContainer.addClass(f.settings.multipleItemsContainerClass),this.multipleItemsContainer.get().style.width=100*f.settings.items.length+'%',this.get().appendChild(this.multipleItemsContainer.get())),l.style.width=100/f.settings.items.length+'%',this.multipleItemsContainer.get().appendChild(l)):this.get().appendChild(l)},this.infoElement=new h(this.settings.infoHtml),this.settings.container.appendChild(this.infoElement.get()),1<this.settings.items.length){this.previousElement=new h(this.settings.previousHtml),this.event.addEvent(this.previousElement.get(),'click',function(){f.showPreviousItem()}),this.settings.container.appendChild(this.previousElement.get()),this.nextElement=new h(this.settings.nextHtml),this.event.addEvent(this.nextElement.get(),'click',function(){f.showNextItem()}),this.settings.container.appendChild(this.nextElement.get()),this.infoElement.addClass(this.settings.multipleItemsClass),this.contentContainerElement.addClass(this.settings.multipleItemsClass);for(var j=0;j<this.settings.items.length;j++)this.addContent(this.settings.items[j]);var k={steps:f.settings.items.length,speed:0.3,loose:!0,requestAnimationFrame:!0,handleClass:f.settings.multipleItemsContainerClass,callback:function(){var l=f.dragdealer.getStep()[0];f.settings.itemsKey=l,f.infoElement.get().innerHTML=f.settings.items[l-1].title?l+'/'+f.settings.items.length+' - '+f.settings.items[l-1].title:l+'/'+f.settings.items.length}};this.settings.pathToRequirejsDragdealer?require([this.settings.pathToRequirejsDragdealer],function(l){f.dragdealer=new l(f.contentContainerElement.get(),k),f.dragdealer.setStep(f.settings.itemsKey+1)}):(f.dragdealer=new Dragdealer(f.contentContainerElement.get(),k),f.dragdealer.setStep(f.settings.itemsKey+1))}else this.addContent(this.settings.items[this.settings.itemsKey]);return document.querySelector('html').classList.add(this.settings.htmlActiveClass),this.event.addEvent(a,'touchmove',this.event.preventDefault),this},this.addContent=function(j){switch(j.mode){case'iframe':this.addContentIframe(j);break;case'get':this.addContentAjax(j,'get');break;case'post':this.addContentAjax(j,'post');break;case'image':this.addContentImage(j);}},this.addContentIframe=function(j){j.contentElement=new h(this.settings.contentHtml),j.contentElement.addClass(this.settings.contentClassIframe),this.contentContainerElement.addContentElement(j.contentElement.get()),j.loadingElement=new h(this.settings.loadingHtml),j.contentElement.get().appendChild(j.loadingElement.get());let k='yes';navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&(j.contentElement.addClass(this.settings.contentClassIos),k='no');var l=new h('<iframe src="'+j.target+'" class="'+this.settings.iframeClass+'" frameborder="0" scrolling="'+k+'"></iframe>');l.hide(),this.settings.iframeTransparencyMode&&(l.get().setAttribute('allowtransparency','true'),l.get().style.backgroundColor='transparent'),j.contentElement.get().appendChild(l.get()),this.event.addEvent(l.get(),'load',function(){l.show(),j.loadingElement.hideAndRemove(),j.title&&1===f.settings.items.length&&(f.infoElement.get().innerHTML=j.title),f.event.itemCallback(j)})},this.addContentAjax=function(j,k){j.contentElement=new h(this.settings.contentHtml),j.contentElement.addClass('get'===k?this.settings.contentClassGet:this.settings.contentClassPost),this.contentContainerElement.addContentElement(j.contentElement.get());let l=new h(this.settings.loadingHtml);j.contentElement.get().appendChild(l.get()),navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&j.contentElement.addClass(this.settings.contentClassIos);var m=new XMLHttpRequest;m.open('get'===k?'GET':'POST',j.target),this.event.addEvent(m,'load',function(){200<=m.status&&300>m.status?(j.contentElement.get().innerHTML=m.responseText,f.event.itemCallback(j)):(j.contentElement.get().innerHTML='ERROR: could not load content from '+j.target+'!',console.warn(m.statusText,m.responseText))}),m.send('post'===k&&j.data?j.data:null)},this.addContentImage=function(j){j.contentElement=new h(this.settings.contentHtml),j.contentElement.addClass(this.settings.contentClassImage),this.contentContainerElement.addContentElement(j.contentElement.get()),j.loadingElement=new h(this.settings.loadingHtml),j.contentElement.get().appendChild(j.loadingElement.get()),this.loadImage(j,function(k,l){switch(k.loadingElement.hideAndRemove(),l){case'error':k.contentElement.get().innerHTML='ERROR: could not load the image from '+k.target+'.';break;case'timeout':k.contentElement.get().innerHTML='ERROR: loading the image from '+k.target+' took too long.';break;default:k.contentElement.get().style.backgroundImage='url('+k.target+')',k.title&&1===f.settings.items.length&&(f.infoElement.get().innerHTML=k.title),f.event.itemCallback(k);}},5e3)},this.loadImage=function(j,k,l){l=l||f.settings.imageLoadTimeout;var n,m=!1,o=new Image;o.onerror=o.onabort=function(){m||(clearTimeout(n),k(j,'error'))},o.onload=function(){m||(clearTimeout(n),k(j,'success'))},o.src=j.target,n=setTimeout(function(){m=!0,o.src='//!!!!/test.jpg',k(j,'timeout')},l)},this.showNextItem=function(){this.dragdealer&&(this.settings.itemsKey=this.settings.itemsKey+1<=this.settings.items.length?this.settings.itemsKey+1:1,this.dragdealer.setStep(this.settings.itemsKey))},this.showPreviousItem=function(){this.dragdealer&&(this.settings.itemsKey=0<this.settings.itemsKey-1?this.settings.itemsKey-1:this.settings.items.length,this.dragdealer.setStep(this.settings.itemsKey))},this.close=function(){return this.backgroundElement&&this.backgroundElement.hideAndRemove(function(){f.backgroundElement=null}),this.closeElement&&this.closeElement.hideAndRemove(function(){f.closeElement=null}),this.contentContainerElement&&(this.contentContainerElement.remove(),this.contentContainerElement=null),this.infoElement&&(this.infoElement.remove(),this.infoElement=null),this.previousElement&&this.previousElement.hideAndRemove(function(){f.previousElement=null}),this.nextElement&&this.nextElement.hideAndRemove(function(){f.nextElement=null}),document.querySelector('html').classList.remove(this.settings.htmlActiveClass),this.event.removeEvent(a,'touchmove',this.event.preventDefault),this}}'function'==typeof define&&define.amd?define(function(){return b}):a.Lightbox=b})(window);