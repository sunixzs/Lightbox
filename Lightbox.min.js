!function(window){"use strict";function Lightbox(params){var self=this;if(this.dragdealer=null,this.settings={items:[],itemsKey:0,container:document.querySelector("body"),backgroundHtml:'<div class="lightbox-background lightbox-opacity-animation"></div>',closeHtml:'<div class="lightbox-close lightbox-opacity-animation"></div>',contentContainerHtml:'<div class="lightbox-content-container lightbox-opacity-animation"></div>',multipleItemsClass:"multiple-items",multipleItemsContainerHtml:"<div></div>",multipleItemsContainerClass:"lightbox-multiple-items-container",contentHtml:'<div class="lightbox-content"></div>',contentClassIos:"ios",contentClassIframe:"lightbox-content-iframe",contentClassImage:"lightbox-content-image",contentClassGet:"lightbox-content-ajax lightbox-content-get",contentClassPost:"lightbox-content-ajax lightbox-content-post",executeAjaxScript:!0,iframeClass:"lightbox-iframe",iframeTransparencyMode:!0,htmlActiveClass:"lightbox-active",previousHtml:'<div class="lightbox-previous lightbox-opacity-animation"></div>',nextHtml:'<div class="lightbox-next lightbox-opacity-animation"></div>',infoHtml:'<div class="lightbox-info lightbox-opacity-animation"></div>',loadingHtml:'<div class="lightbox-loading lightbox-opacity-animation"><i class="fa fa-spinner fa-spin fa-fw"></i></div>',closeOnBackgroundClick:!0,imageLoadTimeout:10,pathToRequirejsDragdealer:"dragdealer.min"},"object"==typeof params)for(var key in params)params.hasOwnProperty(key)&&void 0!==this.settings[key]&&(this.settings[key]=params[key]);this.backgroundElement=null,this.closeElement=null,this.contentContainerElement=null,this.infoElement=null,this.previousElement=null,this.nextElement=null;var Element=function(t){var e=this;return this.isVisible=!0,this.html=t.trim(),this.element=null,this.get=function(){if(null===this.element||"object"!=typeof this.element)if("content"in document.createElement("template")){var t=document.createElement("template");t.innerHTML=this.html,this.element=t.content.firstChild}else{var e=document.createElement("div");e.innerHTML=this.html,this.element=e.firstChild}return this.element},this.show=function(){return!1===this.isVisible&&(this.get().style.opacity=1,this.isVisible=!0),this},this.hide=function(){return!0===this.isVisible&&this.get()&&(this.get().style.opacity=0,this.isVisible=!1),this},this.remove=function(){return this.get()&&this.get().parentNode&&this.get().parentNode.removeChild(this.get()),this},this.hideAndRemove=function(t){return this.hide(),window.setTimeout(function(){e.remove(),"function"==typeof t&&t()},300),this},this.addClass=function(t){if(!this.get())return this;if(0<=t.trim().indexOf(" "))for(var e=t.split(" "),n=0;n<e.length;n++)e[n].trim()&&this.get().classList.add(e[n].trim());else this.get().classList.add(t.trim());return this},this.removeClass=function(t){if(!this.get())return this;if(0<=t.trim().indexOf(" "))for(var e=t.split(" "),n=0;n<e.length;n++)e[n].trim()&&this.get().classList.remove(e[n]);else this.get().classList.remove(t.trim());return this},this.preventTouchmove=function(){self.event.addEvent(this.get(),"touchmove",self.event.preventDefault)},this};this.set=function(t,e){return void 0!==this.settings[t]&&(this.settings[t]=e),this},this.addItem=function(t){return"string"!=typeof t.target?null:(this.settings.items.push({target:t.target,mode:t.mode||"iframe",title:t.title||"",data:t.data||null,callback:t.callback||null}),this)},this.event={addEvent:function(t,e,n){t.addEventListener(e,n,!1)},removeEvent:function(t,e,n){t.removeEventListener(e,n,!1)},preventDefault:function(t){t.preventDefault()},itemCallback:function(t){t.callback&&"function"==typeof t.callback&&t.callback(t,self)}},this.executeScript=function(html){for(var scripts=[];-1<html.indexOf("<script")||-1<html.indexOf("</script");){var start_a=html.indexOf("<script"),start_o=html.indexOf(">",start_a),end_a=html.indexOf("</script",start_a),end_o=html.indexOf(">",end_a);scripts.push(html.substring(start_o+1,end_a)),html=html.substring(0,start_a)+html.substring(end_o+1)}for(var i=0;i<scripts.length;i++)try{eval(scripts[i])}catch(t){console.log(t)}},this.open=function(){if("object"!=typeof this.settings.items[this.settings.itemsKey])return console.log("Error in Lightbox: No items defined!"),null;if(this.backgroundElement=new Element(this.settings.backgroundHtml),this.backgroundElement.hide(),this.backgroundElement.preventTouchmove(),this.settings.container.appendChild(this.backgroundElement.get()),this.backgroundElement.show(),!0===this.settings.closeOnBackgroundClick&&this.event.addEvent(this.backgroundElement.get(),"click",function(){self.close()}),this.closeElement=new Element(this.settings.closeHtml),this.closeElement.preventTouchmove(),this.closeElement.hide(),this.settings.container.appendChild(this.closeElement.get()),this.closeElement.show(),this.event.addEvent(this.closeElement.get(),"click",function(){self.close()}),this.contentContainerElement=new Element(this.settings.contentContainerHtml),this.settings.container.appendChild(this.contentContainerElement.get()),this.contentContainerElement.multipleItemsContainer=null,this.contentContainerElement.addContentElement=function(t){1<self.settings.items.length?(null===this.multipleItemsContainer&&(this.multipleItemsContainer=new Element(self.settings.multipleItemsContainerHtml),this.multipleItemsContainer.addClass(self.settings.multipleItemsContainerClass),this.multipleItemsContainer.get().style.width=100*self.settings.items.length+"%",this.get().appendChild(this.multipleItemsContainer.get())),t.style.width=100/self.settings.items.length+"%",this.multipleItemsContainer.get().appendChild(t)):this.get().appendChild(t)},this.infoElement=new Element(this.settings.infoHtml),this.infoElement.preventTouchmove(),this.settings.container.appendChild(this.infoElement.get()),1<this.settings.items.length){this.previousElement=new Element(this.settings.previousHtml),this.previousElement.preventTouchmove(),this.event.addEvent(this.previousElement.get(),"click",function(){self.showPreviousItem()}),this.settings.container.appendChild(this.previousElement.get()),this.nextElement=new Element(this.settings.nextHtml),this.nextElement.preventTouchmove(),this.event.addEvent(this.nextElement.get(),"click",function(){self.showNextItem()}),this.settings.container.appendChild(this.nextElement.get()),this.infoElement.addClass(this.settings.multipleItemsClass),this.contentContainerElement.addClass(this.settings.multipleItemsClass);for(var t=0;t<this.settings.items.length;t++)this.addContent(this.settings.items[t]);var e={steps:self.settings.items.length,speed:.3,loose:!0,requestAnimationFrame:!0,handleClass:self.settings.multipleItemsContainerClass,callback:function(){var t=self.dragdealer.getStep()[0];self.settings.itemsKey=t,self.infoElement.get().innerHTML=self.settings.items[t-1].title?t+"/"+self.settings.items.length+" - "+self.settings.items[t-1].title:t+"/"+self.settings.items.length}};this.settings.pathToRequirejsDragdealer?require([this.settings.pathToRequirejsDragdealer],function(t){self.dragdealer=new t(self.contentContainerElement.get(),e),self.dragdealer.setStep(self.settings.itemsKey+1)}):(self.dragdealer=new Dragdealer(self.contentContainerElement.get(),e),self.dragdealer.setStep(self.settings.itemsKey+1))}else this.addContent(this.settings.items[this.settings.itemsKey]);return document.querySelector("html").classList.add(this.settings.htmlActiveClass),this},this.addContent=function(t){switch(t.mode){case"iframe":this.addContentIframe(t);break;case"get":this.addContentAjax(t,"get");break;case"post":this.addContentAjax(t,"post");break;case"image":this.addContentImage(t)}},this.addContentIframe=function(t){t.contentElement=new Element(this.settings.contentHtml),t.contentElement.addClass(this.settings.contentClassIframe),this.contentContainerElement.addContentElement(t.contentElement.get()),t.loadingElement=new Element(this.settings.loadingHtml),t.contentElement.get().appendChild(t.loadingElement.get());var e=!1;navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&(t.contentElement.addClass(this.settings.contentClassIos),t.contentElement.get().style.overflow="hidden",e=!0);var n=new Element('<iframe src="'+t.target+'" class="'+this.settings.iframeClass+'" frameborder="0" scrolling="'+(e?"no":"yes")+'"></iframe>');n.hide(),this.settings.iframeTransparencyMode&&(n.get().setAttribute("allowtransparency","true"),n.get().style.backgroundColor="transparent"),t.contentElement.get().appendChild(n.get()),this.event.addEvent(n.get(),"load",function(){n.show(),t.loadingElement.hideAndRemove(),t.title&&1===self.settings.items.length&&(self.infoElement.get().innerHTML=t.title),self.event.itemCallback(t),e&&(t.contentElement.get().style.overflow="auto",n.get().style.height=n.get().contentDocument.body.scrollHeight+"px")})},this.addContentAjax=function(e,t){e.contentElement=new Element(this.settings.contentHtml),e.contentElement.addClass("get"===t?this.settings.contentClassGet:this.settings.contentClassPost),this.contentContainerElement.addContentElement(e.contentElement.get()),e.loadingElement=new Element(this.settings.loadingHtml),e.contentElement.get().appendChild(e.loadingElement.get()),navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&e.contentElement.addClass(this.settings.contentClassIos);var n=new XMLHttpRequest;n.open("get"===t?"GET":"POST",e.target),this.event.addEvent(n,"load",function(t){200<=n.status&&n.status<300?(e.contentElement.get().innerHTML=n.responseText,self.event.itemCallback(e),self.settings.executeAjaxScript&&self.executeScript(n.responseText)):(e.contentElement.get().innerHTML="ERROR: could not load content from "+e.target+"!",console.warn(n.statusText,n.responseText))}),n.send("post"===t&&e.data?e.data:null)},this.addContentImage=function(t){t.contentElement=new Element(this.settings.contentHtml),t.contentElement.addClass(this.settings.contentClassImage),this.contentContainerElement.addContentElement(t.contentElement.get()),t.loadingElement=new Element(this.settings.loadingHtml),t.contentElement.get().appendChild(t.loadingElement.get()),this.loadImage(t,function(t,e){switch(t.loadingElement.hideAndRemove(),e){case"error":t.contentElement.get().innerHTML="ERROR: could not load the image from "+t.target+".";break;case"timeout":t.contentElement.get().innerHTML="ERROR: loading the image from "+t.target+" took too long.";break;default:t.contentElement.get().style.backgroundImage="url("+t.target+")",t.title&&1===self.settings.items.length&&(self.infoElement.get().innerHTML=t.title),self.event.itemCallback(t)}},1e3*self.settings.imageLoadTimeout)},this.loadImage=function(t,e,n){n=n||1e3*self.settings.imageLoadTimeout;var i,s=!1,l=new Image;l.onerror=l.onabort=function(){s||(clearTimeout(i),e(t,"error"))},l.onload=function(){s||(clearTimeout(i),e(t,"success"))},l.src=t.target,i=setTimeout(function(){s=!0,l.src="//!!!!/test.jpg",e(t,"timeout")},n)},this.showNextItem=function(){this.dragdealer&&(this.settings.itemsKey=this.settings.itemsKey+1<=this.settings.items.length?this.settings.itemsKey+1:1,this.dragdealer.setStep(this.settings.itemsKey))},this.showPreviousItem=function(){this.dragdealer&&(this.settings.itemsKey=0<this.settings.itemsKey-1?this.settings.itemsKey-1:this.settings.items.length,this.dragdealer.setStep(this.settings.itemsKey))},this.close=function(){return this.backgroundElement&&this.backgroundElement.hideAndRemove(function(){self.backgroundElement=null}),this.closeElement&&this.closeElement.hideAndRemove(function(){self.closeElement=null}),this.contentContainerElement&&(this.contentContainerElement.remove(),this.contentContainerElement=null),this.infoElement&&(this.infoElement.remove(),this.infoElement=null),this.previousElement&&this.previousElement.hideAndRemove(function(){self.previousElement=null}),this.nextElement&&this.nextElement.hideAndRemove(function(){self.nextElement=null}),document.querySelector("html").classList.remove(this.settings.htmlActiveClass),this}}"function"==typeof define&&define.amd?define(function(){return Lightbox}):window.Lightbox=Lightbox}(window);